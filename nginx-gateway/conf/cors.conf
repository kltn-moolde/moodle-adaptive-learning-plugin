# CORS Configuration
# Handle Cross-Origin Resource Sharing

map $http_origin $cors_origin {
    default "";
    ~^https?://(localhost|127\.0\.0\.1)(:[0-9]+)?$ $http_origin;
    ~^https?://.*\.yourdomain\.com$ $http_origin;
}

map $request_method $cors_method {
    default "allowed";
    OPTIONS "preflight";
}

# CORS headers for API requests
map $cors_method $cors_max_age {
    default "";
    preflight 86400;
}

map $cors_method $cors_allow_methods {
    default "";
    preflight "GET, POST, PUT, DELETE, OPTIONS, PATCH";
}

map $cors_method $cors_allow_headers {
    default "";
    preflight "Accept,Authorization,Cache-Control,Content-Type,DNT,If-Modified-Since,Keep-Alive,Origin,User-Agent,X-Requested-With,X-CSRF-Token,X-API-Key";
}
